
# █▀▀ █▀▀ █▄░█ █▀▀ █▀█ ▄▀█ █░░
# █▄█ ██▄ █░▀█ ██▄ █▀▄ █▀█ █▄▄

general {
    # layout = master
    # no_cursor_warps = true
}


xwayland {
force_zero_scaling = true
}


# █▀▀ █▄░█ █░█
# ██▄ █░▀█ ▀▄▀

# Some default env vars.
# Multi-GPU
# zen amd_fisrt
# env = WLR_DRM_DEVICES,/dev/dri/card2:/dev/dri/card1
# zen nvidia_fisrt
# env = WLR_DRM_DEVICES,/dev/dri/card1:/dev/dri/card2
# lts amd_fisrt
# env = WLR_DRM_DEVICES,/dev/dri/card1:/dev/dri/card0
# lts nvidia_fisrt
# env = WLR_DRM_DEVICES,/dev/dri/card0:/dev/dri/card1
# env = WLR_DRM_DEVICES,/dev/dri/card1

# █░░ ▄▀█ █░█ █▄░█ █▀▀ █░█
# █▄▄ █▀█ █▄█ █░▀█ █▄▄ █▀█

# See https://wiki.hyprland.org/Configuring/Keywords/ for more
# Execute your favorite apps at launch

exec-once = ags
exec-once = pypr
exec-once = libinput-gestures
exec-once = waypaper --restore
exec-once = sway-audio-idle-inhibit
exec-once = swayidle -w timeout 600 'hyprctl dispatch dpms off' resume 'hyprctl dispatch dpms on' before-sleep 'swaylock'  timeout 1200 'systemctl suspend' # resume 'hyprctl dispatch dpms on'  # turn off monitor after 15 mins
exec-once = fcitx5 -d --replace
exec-once = fcitx5-remote -r
exec-once = 1password --silent --no-sandbox # start 1password
# exec-once = clash-verge --silent --no-sandbox # start clash-verge
exec-once = sleep 2 && cfw --silent --no-sandbox # start cfw
exec-once = ~/.config/hypr/scripts/handle_monitor_connect.sh
# exec-once = clash-nyanpasu --silent --no-sandbox # start clash-verge
# exec-once = sleep 1 && waypaper-engine #start the waypaper-engine


# █ █▄░█ █▀█ █░█ ▀█▀
# █ █░▀█ █▀▀ █▄█ ░█░

# For all categories, see https://wiki.hyprland.org/Configuring/Variables/

# $sys_monitor = kitty btop

input {
    # Mouse
    accel_profile = adaptive
    force_no_accel = false
    sensitivity = 0

    # Keyboard
    repeat_delay = 250
    repeat_rate = 35
    numlock_by_default = true
    kb_options = ctrl:nocaps #remap-caps-lock-to-ctrl

    touchpad {
        natural_scroll = yes
        disable_while_typing = true
        clickfinger_behavior = true
        scroll_factor = 0.5
    }
    scroll_method = 2fg
}

binds {
    # focus_window_on_workspace_change = true
    scroll_event_delay = 0
}


gestures {
    # See https://wiki.hyprland.org/Configuring/Variables/ for more
    workspace_swipe = true
    workspace_swipe_distance = 700
    workspace_swipe_fingers = 4
    workspace_swipe_cancel_ratio = 0.2
    workspace_swipe_min_speed_to_force = 5

    workspace_swipe_direction_lock = true
    workspace_swipe_direction_lock_threshold = 0
    
    workspace_swipe_create_new = true
    
}

misc {
    # vrr = 1
    # vfr = true
    focus_on_activate = true
    #suppress_portal_warnings = true
    enable_swallow = true
    
    disable_hyprland_logo = true
    force_hypr_chan = true
    new_window_takes_over_fullscreen = 2
}

# Reduce power consumption
# decoration {
    # blur = false
    # drop_shadow = false
# }


# █▄▀ █▀▀ █▄█ █▄▄ █ █▄░█ █▀▄ █ █▄░█ █▀▀ █▀
# █░█ ██▄ ░█░ █▄█ █ █░▀█ █▄▀ █ █░▀█ █▄█ ▄█


# See https://wiki.hyprland.org/Configuring/Keywords/ for more
# Example binds, see https://wiki.hyprland.org/Configuring/Binds/ for more

#fctix5
bind = ALT,E,exec,pkill fcitx5 -9;sleep 1;fcitx5 -d --replace; sleep 1;fcitx5-remote -r

#hyprpicker
bind = CTRL ALT, Z, exec, hyprpicker -a

# dolphin
bind = $mainMod SHIFT, E, exec, dolphin

#TODO custom monitor
# bind=CTRL SUPER SHIFT, P, exec, code ~/.config/hypr/monitors.conf
bind = CTRL SUPER SHIFT, P, exec, ~/.local/bin/nvim.sh ~/.config/hypr/monitors.conf

# Window/Session actions
bind = CTRL SHIFT, Q, exec, ~/.config/hypr/scripts/dontkillsteam.sh # killactive, kill the window on focus
bind = $mainMod , O, fullscreen,1
bind = $mainMod ALT, O, fullscreen,0 # toggle the window on focus to fullscreen
bind = $mainMod, code:61, exec, swaylock # lock screen

# Application shortcuts
bind = CTRL SHIFT, A, exec, $term  # open terminal
# bind = CTRL SHIFT, X, exec, $editor # open vscode
bind = CTRL SHIFT, X, exec, ~/.local/bin/nvim.sh
# bind = CTRL SHIFT, S, exec, google-chrome-beta # open google-chrome-beta
bind = CTRL SUPER SHIFT,I, exec, systemsettings # open sysytemsettings
bind = CTRL ALT, I, exec, XDG_CURRENT_DESKTOP="gnome" gnome-control-center
# Apps: Settings and config
# bind = CTRL SUPER SHIFT,I, exec, XDG_CURRENT_DESKTOP="gnome" gnome-control-center

# pass key to applications
bind = $mainMod,F10,pass,^(com\.obsproject\.Studio)$
# bind = CTRL SHIFT, Z,pass,^(1Password)$

bind = $mainMod SHIFT, G, exec, ~/.config/hypr/scripts/gamelauncher.sh 5

# Rofi is toggled on/off if you repeat the key presses
bind = ALT, SPACE, exec, pkill -x rofi || ~/.config/hypr/scripts/rofilaunch.sh d # launch desktop applications


# Screenshot/Screencapture
bind = CTRL ALT, A, exec, ~/.config/hypr/scripts/screenshot.sh s # drag to snip an area / click on a window to print it
bind = CTRL ALT, S, exec, [float;pin] grim -g "$(slurp -d)" - |tee "~/Pictures/Screenshots/$(date +'%H:%M:%S@%m-%d').png" | cliphist store &&cliphist list | head -n 1 | cliphist decode| feh -. -

# ToggleGroupChange
bind = $mainMod SHIFT, O, moveoutofgroup
bind = $mainMod SHIFT, I, moveintogroup ,l
bind = $mainMod SHIFT, I, moveintogroup ,r
bind = $mainMod SHIFT, I, moveintogroup ,u
bind = $mainMod SHIFT, I, moveintogroup ,d
bind = ALT, TAB, changegroupactive,f
bind = ALT, F, movegroupwindow, f
bind = ALT, B, movegroupwindow, b

#centerwindow
bind = $mainMod, Z, centerwindow


# float window behave
# bind = $mainMod, W, togglefloating, # toggle the window on focus to float
bind = $mainMod, W, centerwindow # center the window on focus
bind = $mainMod, W,resizeactive, exact 50% 60% # resize the window on focus to 50% width and 60% height


# Move focus with mainMod + arrow keys
bind = ALT, H, movefocus, l
bind = ALT, L, movefocus, r
bind = ALT, K, movefocus, u
bind = ALT, J, movefocus, d
bind = ALT, I, movefocus, u # circle focus


# Switch workspaces with mainMod + [0-9]
bind = $mainMod, N, workspace,e+1
bind = $mainMod, P, workspace,e-1
# TODO: special
# bind = $mainMod, +,  workspace,empty
bind = $mainMod CTRL SHIFT, N,  movetoworkspace,empty
bind = $mainMod CTRL SHIFT, O,  workspace,empty


# Resize windows
binde = $mainMod SHIFT, L, resizeactive, 30 0
binde = $mainMod SHIFT, H, resizeactive, -30 0
binde = $mainMod, code:21, resizeactive, 30 0
binde = $mainMod, code:20, resizeactive, -30 0
binde = $mainMod SHIFT, K, resizeactive, 0 -30
binde = $mainMod SHIFT, J, resizeactive, 0 30

# Move active window to a workspace with mainMod + SHIFT + [0-9]
bind = $mainMod SHIFT, N,  movetoworkspace,e+1
bind = $mainMod SHIFT, P,  movetoworkspace,e-1


# Move active window around current workspace with mainMod + SHIFT + CTRL [←→↑↓]
bind = $mainMod, left, movewindow, l
bind = $mainMod, right, movewindow, r
bind = $mainMod, up, movewindow, u
bind = $mainMod, down, movewindow, d
bind = $mainMod, H, movewindow, l
bind = $mainMod, L, movewindow, r
bind = $mainMod, K, movewindow, u
bind = $mainMod, J, movewindow, d


#MOUSE ACTIONS
bind = $mainMod,mouse:274, fullscreen
bind = CTRL, mouse:274,exec, ~/.config/hypr/scripts/dontkillsteam.sh
bind = CTRL, mouse:273, togglefloating
bind = ALT, mouse:272, movetoworkspace,empty
bind = ALT, mouse:273, workspace,empty
bind = $mainMod SHIFT, mouse:272, movetoworkspace,empty
bind = $mainMod SHIFT, mouse:273, workspace,empty
bind = $mainMod SHIFT, mouse_down, movetoworkspace, e+1
bind = $mainMod SHIFT, mouse_up, movetoworkspace, e-1
bind = CTRL SHIFT, mouse:272, movetoworkspacesilent,e-1
bind = CTRL SHIFT, mouse:273, movetoworkspacesilent,e+1
bind = CTRL SHIFT, mouse_down, movetoworkspacesilent, e+1
bind = CTRL SHIFT, mouse_up, movetoworkspacesilent, e-1


# Special workspaces (scratchpad)
# bind = $mainMod,M, movetoworkspacesilent, special

# Toggle Layout
bind = $mainMod, I, togglesplit, # dwindle


# Move window silently to workspace Super + Alt + [0-9]
bind = $mainMod ALT, N, movetoworkspacesilent, e+1

# toggleallfloating mode
bind = $mainMod SHIFT, F, workspaceopt, allfloat

# resize windows when only use touchpad
bindm=SUPER_CTRL, mouse:272, resizewindow

# ags
# reload
bind = CTRL SHIFT, R, exec, ags quit;ags
# opening windowk
bind = $mainMod, A, exec, ags -t applauncher
bind =,XF86PowerOff,  exec, ags -t powermenu
bind = $mainMod, Tab, exec, ags -t overview
# screenshot & screenrecord
bind=,XF86Launch4,  exec, ags -r 'recorder.start()'
bind=,Print,         exec, ags -r 'recorder.screenshot()'
bind=SHIFT,Print,    exec, ags -r 'recorder.screenshot(true)'
# brightness adjusting
bindle=,XF86MonBrightnessUp,   exec, ags -r 'brightness.screen += 0.05; indicator.display()'
bindle=,XF86MonBrightnessDown, exec, ags -r 'brightness.screen -= 0.05; indicator.display()'
bindle=,XF86KbdBrightnessUp,   exec, ags -r 'brightness.kbd++; indicator.kbd()'
bindle=,XF86KbdBrightnessDown, exec, ags -r 'brightness.kbd--; indicator.kbd()'
# volume adjusting
bindle=,XF86AudioRaiseVolume,  exec, ags -r 'audio.speaker.volume += 0.05; indicator.speaker()'
bindle=,XF86AudioLowerVolume,  exec, ags -r 'audio.speaker.volume -= 0.05; indicator.speaker()'

#moveactive
bind = $mainMod SHIFT, M, submap, moveactive
submap = moveactive

binde = ,H, moveactive, -50 0
binde = ,L, moveactive, 50 0
binde = ,K, moveactive, 0 -50
binde = ,J, moveactive, 0 50

binde = $mainMod SHIFT, L, resizeactive, 30 0
binde = $mainMod SHIFT, H, resizeactive, -30 0
binde = $mainMod SHIFT, K, resizeactive, 0 -30
binde = $mainMod SHIFT, J, resizeactive, 0 30

bind = $mainMod SHIFT, F, workspaceopt, allfloat

bind = ALT, H, movefocus, l
bind = ALT, L, movefocus, r
bind = ALT, K, movefocus, u
bind = ALT, J, movefocus, d

bind = $mainMod, H, movewindow, l
bind = $mainMod, L, movewindow, r
bind = $mainMod, K, movewindow, u
bind = $mainMod, J, movewindow, d

bind = $mainMod, W, togglefloating, # toggle the window on focus to float

bind = $mainMod, I, togglesplit, # dwindle

bind = $mainMod, Z, centerwindow

bind = CTRL SHIFT, Q, exec, ~/.config/hypr/scripts/dontkillsteam.sh # killactive, kill the window on focus
bind = $mainMod, O, fullscreen, # toggle the window on focus to fullscreen
bind = $mainMod SHFIT, O, fakefullscreen

bind = ALT, SPACE, exec, pkill -x rofi || ~/.config/hypr/scripts/rofilaunch.sh d # launch desktop applications

bind = CTRL SHIFT, A, exec, $term  # open terminal
bind = $mainMod, RETURN, exec, [float;size 50% 65%;center]$term # open terminal
bind = $mainMod, V, exec, pkill -x rofi || ~/.config/hypr/scripts/cliphist.sh c  # open Pasteboard in screen center
bind = CTRL ALT, Z, exec, hyprpicker -a
bind = CTRL SUPER SHIFT, P, exec, ~/.local/bin/nvim.sh ~/.config/hypr/monitors.conf
bind = CTRL SHIFT, X, exec, ~/.local/bin/nvim.sh
bind = CTRL SHIFT, S, exec, google-chrome-stable # open google-chrome-stable
bind = CTRL SUPER SHIFT,I, exec, systemsettings # open sysytemsettings
bind = CTRL ALT, I, exec, XDG_CURRENT_DESKTOP="gnome" gnome-control-center

bind = $mainMod, Tab, exec, ags -t overview
bind = CTRL SHIFT, R, exec, ags quit;ags

bind =  ,M,submap,reset

submap = reset

# Passthrough SUPER KEY to Virtual Machine
bind = $mainMod, Escape, submap, passthru
submap = passthru
bind = SUPER, Escape, submap, reset
submap = reset


#### pyprland ###
# bind = $mainMod, RETURN, exec, [float;size 50% 65%;center]$term # open terminal
# scratchpad
bind = SUPER,RETURN,exec,pypr toggle $term && hyprctl dispatch bringactivetotop
bind = $mainMod, T, exec,pypr toggle ranger && hyprctl dispatch bringactivetotop # open terminal
bind = $mainMod, R,exec,pypr toggle pavucontrol && hyprctl dispatch bringactivetotop
bind = $mainMod, E, exec, pypr toggle nautilus && hyprctl dispatch bringactivetotop # open nautilus
bind = CTRL SHIFT, S, exec,pypr toggle google-chrome-stable && hyprctl dispatch bringactivetotop # open google-chrome-stable
bind = $mainMod, F, exec,pypr toggle firefox && hyprctl dispatch bringactivetotop # open firefox
bind = $mainMod, code:51, exec, pypr toggle cava && hyprctl dispatch bringactivetotop

# shift_monitors
bind = $mainMod SHIFT, O, exec, pypr shift_monitors +1

# expose
bind = $mainMod , S, togglespecialworkspace, minimized
bind = $mainMod, M, exec, pypr toggle_minimized
bind = $mainMod SHIFT, S, exec, pypr toggle_minimized


# temp unused
bind = $mainMod, B, exec, pypr expose

# bind = $mainMod,A,exec,pypr toggle term
# $dropterm  = ^(kitty-dropterm)$
# windowrule = float,$dropterm
# windowrule = workspace special:scratch_term silent,$dropterm
# windowrule = size 75% 60%,$dropterm
# windowrule = move 12% -200%,$dropterm

$scratchpadsize = size 50% 65%
$scratchpad = class:^(scratchpad)$
windowrulev2 = float,$scratchpad
windowrulev2 = $scratchpadsize,$scratchpad
windowrulev2 = workspace special silent,$scratchpad
windowrulev2 = center,$scratchpad
windowrulev2 = noblur,$scratchpad
windowrulev2 = opacity 0.85,$scratchpad 


$pavucontrol = class:^(pavucontrol)$
windowrulev2 = float,$pavucontrol
windowrulev2 = size 86% 40%,$pavucontrol
windowrulev2 = move 50% 6%,$pavucontrol
windowrulev2 = workspace special silent,$pavucontrol
windowrulev2 = opacity 0.80 0.80,$pavucontrol
#### pyprland ###

bind = $mainMod, X, exec,~/.config/hypr/scripts/areaterm.sh

# plugin {
#     split-monitor-workspaces {
#         count = 5
#     }
# }
#
# $mainMod = SUPER
# # Switch workspaces with mainMod + [0-5]
# bind = $mainMod, 1, split-workspace, 1
# bind = $mainMod, 2, split-workspace, 2
# bind = $mainMod, 3, split-workspace, 3
# bind = $mainMod, 4, split-workspace, 4
# bind = $mainMod, 5, split-workspace, 5
#
# # Move active window to a workspace with mainMod + SHIFT + [0-5]
# bind = $mainMod SHIFT, 1, split-movetoworkspacesilent, 1
# bind = $mainMod SHIFT, 2, split-movetoworkspacesilent, 2
# bind = $mainMod SHIFT, 3, split-movetoworkspacesilent, 3
# bind = $mainMod SHIFT, 4, split-movetoworkspacesilent, 4
# bind = $mainMod SHIFT, 5, split-movetoworkspacesilent, 5

# █░█░█ █ █▄░█ █▀▄ █▀█ █░█░█   █▀█ █░█ █░░ █▀▀ █▀
# ▀▄▀▄▀ █ █░▀█ █▄▀ █▄█ ▀▄▀▄▀   █▀▄ █▄█ █▄▄ ██▄ ▄█

#Google-chrome
windowrulev2 = opacity 0.80 0.80,class:^(Google-chrome)$
# windowrulev2 = noblur,class:^(Google-chrome)$

#firefox-nightly
windowrulev2 = opacity 0.80 0.80,class:^(firefox-nightly)$
#firefox
windowrulev2 = opacity 0.80 0.80,class:^(firefox)$

#QQ
windowrule = float, ^(QQ)$
# windowrule = size 65% 65%, ^(QQ)$
windowrule = center, ^(QQ)$
windowrulev2 = opacity 0.80 0.80,class:^(QQ)$

#Feishu
windowrule = float, ^(Feishu)
windowrule = float, ^(Meeting)
# windowrulev2 = stayfocused,class:^(Meeting)$
# windowrulev2 = stayfocused,title:^(飞书会议)$
# windowrulev2 = float, title:^(飞书会议)$
# windowrulev2 = noblur,class:^(Feishu)$
# windowrule = size 65% 65%, ^(Feishu)$
# windowrule = center, ^(Feishu)$
# windowrulev2 = noanim, class:^(.*Feishu.*)$, title:^(win.*)$
# windowrulev2 = windowdance, class:^(.*Feishu.*)$
# windowrulev2 = noinitialfocus, class:^(.*Feishu.*)$, title:^(win.*)$

#1Password
windowrulev2 = stayfocused,title:^(Quick Access — 1Password)$
windowrule = float, ^(1Password)$
windowrule = center, ^(1Password)$

#yesplaymusic
windowrule = float, ^(yesplaymusic)$
windowrule = center, ^(yesplaymusic)$
windowrulev2 = noblur,class:^(yesplaymusic)$
windowrulev2 = size 65% 65% ,class:^yesplaymusic
windowrulev2 = opacity 0.90 0.90,class:^yesplaymusic

#clash
windowrulev2 = float,class:^(Clash for Windows)$
windowrulev2 = float,class:^(clash-verge)$
# windowrulev2 = size 65% 65% ,title:^Clash
# windowrule = center,title:^Clash
# windowrulev2 =  animation slide,title:^Clash


#telegram
windowrule = float, ^(org.telegram.desktop)$
windowrule = size 65% 65%, ^(org.telegram.desktop)$
windowrule = center, ^(org.telegram.desktop)$
windowrulev2 = opacity 0.80 0.80,class:^org.telegram.desktop


#discord
windowrule = float, ^(discord)$
windowrule = size 65% 65%, ^(discord)$
windowrule = center, ^(discord)$
windowrulev2 = opacity 0.80 0.80,class:^discord


#obssudio
# windowrule = float, ^(com.obsproject.Studio)$
# windowrule = size 60% 60%, ^(com.obsproject.Studio)$
windowrule = center, ^(com.obsproject.Studio)$
windowrulev2 = opacity 0.80 0.80,class:^discord

# wps family
# windowrule = tile, ^(wps)$

windowrulev2 = tile, title:^(WPS文字)$
# windowrulev2 = tile, title:^(WPS演示)$
# windowrulev2 = float, title:^(WPS PDF)$

windowrulev2 = opacity 0.80 0.80,class:^wps


windowrule = float, ^(pdf)$
windowrulev2 = opacity 0.80 0.80,class:^pdf


windowrule = float, ^(wpp)$
windowrulev2 = opacity 0.80 0.80,class:^wpp


windowrule = float, ^(et)$
windowrulev2 = opacity 0.80 0.80,class:^et

#fcitx5
windowrule=pseudo,fcitx
windowrulev2 = noblur,class:^(fcitx)$

#jetbrains
windowrulev2 = opacity 0.80 0.80,class:^(.*jetbrains.*)$
#windowrulev2=forceinput,class:^(jetbrains-.*)
#windowrulev2=windowdance,class:^(jetbrains-.*)
#windowrule=noanim,^(jetbrains-*)$
#windowrulev2=dimaround,class:^(jetbrains-*)$,title:^((Select)|(Choose) )
# windowrulev2 = noblur,class:^(.*jetbrains.*)$

# windowrulev2 = noanim, class:^(.*jetbrains.*)$, title:^(win.*)$
# windowrulev2 = windowdance, class:^(.*jetbrains.*)$
# windowrulev2 = noinitialfocus, class:^(.*jetbrains.*)$, title:^(win.*)$

windowrulev2=windowdance,class:^(jetbrains-.*)$
# search dialog
windowrulev2=dimaround,class:^(jetbrains-.*)$,floating:1,title:^(?!win)
windowrulev2=center,class:^(jetbrains-.*)$,floating:1,title:^(?!win)
# autocomplete & menus
windowrulev2=noanim,class:^(jetbrains-.*)$,title:^(win.*)$
windowrulev2=noinitialfocus,class:^(jetbrains-.*)$,title:^(win.*)$
windowrulev2=rounding 0,class:^(jetbrains-.*)$,title:^(win.*)$

#apifox
windowrulev2 = opacity 0.70 0.70,class:^(apifox)$

#postman
windowrulev2 = opacity 0.70 0.70,class:^(Postman)$

#Waydroid
windowrule = float, ^(Waydroid)$

# kde connect
windowrule = float, ^(org.kde.kdeconnect.app)$

# ags
# Settings
windowrulev2=float,class:^(com.github.Aylur.ags)$,title:^(Settings)$
windowrulev2=size 50% 50%,class:^(com.github.Aylur.ags)$,title:^(Settings)$
windowrulev2=center,class:^(com.github.Aylur.ags)$,title:^(Settings)$

# waypaper-engine
windowrulev2=float,class:^(waypaper-engine)$

# waypaper
windowrulev2=float,class:^(waypaper)$

# cava
windowrulev2 = float,          class:(kitty),title:(cava)
# windowrulev2 = pin,            class:(kitty),title:(cava)
windowrulev2 = noanim,         class:(kitty),title:(cava)
windowrulev2 = noblur,         class:(kitty),title:(cava)
windowrulev2 = noborder,       class:(kitty),title:(cava)
windowrulev2 = nodim,          class:(kitty),title:(cava)
windowrulev2 = nofocus,        class:(kitty),title:(cava)
windowrulev2 = noinitialfocus, class:(kitty),title:(cava)
windowrulev2 = noshadow,       class:(kitty),title:(cava)
windowrulev2 = rounding 0,     class:(kitty),title:(cava)
windowrulev2 = size 100% 50%,  class:(kitty),title:(cava)
windowrulev2 = move 0% 50.2%,  class:(kitty),title:(cava)

# nvim
windowrulev2 = opacity 0.80 0.80,class:(nvim),title:(nvim)

# flameshot
windowrulev2 = float,class:(flameshot),title:(flameshot)
